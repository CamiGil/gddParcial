-- LO QUE YO HICE
SELECT YEAR(F.FACT_FECHA) AS 'ANIO',
	(SELECT COUNT (DISTINCT C.comp_producto)
	FROM COMPOSICION C 
	JOIN PRODUCTO P2 ON P2.PROD_CODIGO = C.COMP_PRODUCTO
	JOIN ITEM_FACTURA ITF2 ON ITF2.item_producto = P2.prod_codigo
	JOIN FACTURA F2 ON ITF2.item_numero = F2.fact_numero
		AND ITF2.item_sucursal = F2.fact_sucursal
		AND ITF2.item_tipo = F2.fact_tipo
	WHERE YEAR(F2.fact_fecha) = YEAR(F.FACT_FECHA)
	GROUP BY YEAR(F2.fact_fecha) ) AS 'CANT COMPUESTOS'
FROM FACTURA F
GROUP BY YEAR(F.FACT_FECHA)

-- OTRA SOLUCION 
SELECT YEAR(F.FACT_FECHA) AS 'ANIO',
	(SELECT COUNT (DISTINCT itf2.item_producto)
	FROM FACTURA F2
	JOIN ITEM_FACTURA ITF2 ON ITF2.item_numero = F2.fact_numero
		AND ITF2.item_sucursal = F2.fact_sucursal
		AND ITF2.item_tipo = F2.fact_tipo
	WHERE YEAR(F2.fact_fecha) = YEAR(F.FACT_FECHA)
		AND ITF2.item_producto IN (SELECT DISTINCT COMP_PRODUCTO
									FROM COMPOSICION)
	) AS 'CANT COMPUESTOS'
FROM FACTURA F
GROUP BY YEAR(F.FACT_FECHA)
